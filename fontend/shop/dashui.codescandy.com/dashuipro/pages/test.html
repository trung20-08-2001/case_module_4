<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

</head>
<body>
<input type="file" id="img"  >
<button onclick="upload()">Upload</button>
<div id="test"></div>

<input type="file" id="imageInput" accept="image/*">
<div id="imagePreview"></div>

<input type="file" id="file-input" multiple>
<script>
    const fileInput = document.getElementById('file-input');
    const files = [];

    fileInput.addEventListener('change', (event) => {
        const fileList = event.target.files;
        for (let i = 0; i < fileList.length; i++) {
            files.push(fileList[i]);
        }
        console.log(files); // In ra mảng các file đã được lưu
    });
</script>
</body>
</html>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use -->
<script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-storage.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyC1HN8OeYScrl6IWC3rk37FxncDgt3WNE4",
    authDomain: "commerce-website-acf59.firebaseapp.com",
    databaseURL: "https://commerce-website-acf59-default-rtdb.firebaseio.com",
    projectId: "commerce-website-acf59",
    storageBucket: "commerce-website-acf59.appspot.com",
    messagingSenderId: "709514506361",
    appId: "1:709514506361:web:43c53da1978e3cad7764a8",
    measurementId: "G-STT0P32LY3"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  let b;
  function upload() {
      return new Promise((resolve, reject) => {
          const ref = firebase.storage().ref();
          const file = document.getElementById("img").files[0];
          const name = file.name;
          const metadata = {
              contentType: file.type
          }
          const task = ref.child(name).put(file, metadata);
          task.then(snapshot => {
              snapshot.ref.getDownloadURL()
                  .then(url => {
                      resolve(url);
                      // thay đổi img của sản phẩm
                  }).catch(error => {
                  reject(error);
              });
          }).catch(error => {
              reject(error);
          });
      });
  }

  $(document).ready(function() {
      $('#imageInput').on('change', function() {
          const file = this.files[0];
          if (file) {
              const reader = new FileReader();
              reader.onload = function() {
                  const image = new Image();
                  image.src = reader.result;
                  $('#imagePreview').append(image);
              };

              reader.readAsDataURL(file);
          }
      });
  });
</script>
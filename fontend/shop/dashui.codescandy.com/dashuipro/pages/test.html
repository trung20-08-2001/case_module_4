<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

    <style>
        .image-container {
            position: relative;
            display: inline-block;
        }

        .delete-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.5);
            color: red;
            font-size: 16px;
            padding: 8px 16px;
            border-radius: 50%;
            cursor: pointer;
            display: none;
        }

        .image-container:hover .delete-btn {
            display: block;
        }
    </style>
</head>
<body>
<!--<input type="file" id="img"  >-->
<!--<button onclick="upp2()">Upload</button>-->
<!--<div id="test"></div>-->

<!--<input type="file" id="imageInput" accept="image/*">-->
<!--<div id="imagePreview"></div>-->

<!--<input type="file" id="file-input" multiple>-->

<div class="image-container">
    <img src="https://kenh14cdn.com/2018/01-1514877838689.jpg" alt="Ảnh" width="100" height="100">
    <div class="delete-btn">
        <span class="glyphicon glyphicon-remove"></span>
    </div>
</div>
<script>
    const files = [];
    $('#file-input').on('change', function() {
        const fileList = $(this).prop('files');
        for (let i = 0; i < fileList.length; i++) {
            files.push(fileList[i]);
        }
        console.log(files); // In ra mảng các file đã được lưu
    });
</script>
</body>
</html>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use -->
<script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-storage.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyC1HN8OeYScrl6IWC3rk37FxncDgt3WNE4",
    authDomain: "commerce-website-acf59.firebaseapp.com",
    databaseURL: "https://commerce-website-acf59-default-rtdb.firebaseio.com",
    projectId: "commerce-website-acf59",
    storageBucket: "commerce-website-acf59.appspot.com",
    messagingSenderId: "709514506361",
    appId: "1:709514506361:web:43c53da1978e3cad7764a8",
    measurementId: "G-STT0P32LY3"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  let b;
  function upload() {
      for (let i = 0; i < files.length; i++) {
          return new Promise((resolve, reject) => {
              const ref = firebase.storage().ref();
              const file = files[i];
              const name = file.name;
              const metadata = {
                  contentType: file.type
              }
              const task = ref.child(name).put(file, metadata);
              task.then(snapshot => {
                  snapshot.ref.getDownloadURL()
                      .then(url => {
                          resolve(url);
                          console.log(url)
                          // thay đổi img của sản phẩm
                      }).catch(error => {
                      reject(error);
                  });
              }).catch(error => {
                  reject(error);
              });
          });
      }
  }

  function upp2(){
      for (let i = 0; i < files.length; i++) {
          const promise = new Promise((resolve, reject) => {
              const ref = firebase.storage().ref();
              const file = files[i];
              const name = file.name;
              const metadata = { contentType: file.type };
              const task = ref.child(name).put(file, metadata);
              task.then((snapshot) => {
                  snapshot.ref.getDownloadURL().then((url) => {
                      resolve(url);
                      console.log(url);
                      // thay đổi img của sản phẩm
                  }).catch((error) => {
                      reject(error);
                  });
              }).catch((error) => {
                  reject(error);
              });
          });
      }

  }

  $(document).ready(function() {
      $('#imageInput').on('change', function() {
          const file = this.files[0];
          if (file) {
              const reader = new FileReader();
              reader.onload = function() {
                  const image = new Image();
                  image.src = reader.result;
                  $('#imagePreview').append(image);
              };

              reader.readAsDataURL(file);
          }
      });
  });

  $(document).ready(function() {
      $('.image-container').hover(
          function() {
              $(this).find('.delete-btn').fadeIn();
          },
          function() {
              $(this).find('.delete-btn').fadeOut();
          }
      );

      $('.delete-btn').click(function() {
          $(this).closest('.image-container').remove();
          // Thực hiện xóa ảnh tại đây
      });
  });
</script>